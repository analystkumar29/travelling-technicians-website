"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{4978:function(e,s,a){a.d(s,{Z:function(){return PostalCodeChecker}});var r=a(5893),i=a(7294),t=a(5154),o=a(3597);function PostalCodeChecker(e){let{className:s="",variant:a="default",onSuccess:c,onError:l}=e,[n,m]=(0,i.useState)(""),[y,d]=(0,i.useState)(!1),[u,v]=(0,i.useState)(!1),[p,h]=(0,i.useState)(null),[b,V]=(0,i.useState)(null),[g,x]=(0,i.useState)(!1),[f,T]=(0,i.useState)(null),D=(0,i.useRef)(null);(0,i.useEffect)(()=>{"default"===a&&D.current&&D.current.focus()},[a]);let handleSubmit=e=>{if(e.preventDefault(),h(null),x(!0),T(null),!n.trim()){let e="Please enter a postal code";h(e),V(null),l&&l(e);return}if(!(0,o.MM)(n)){let e="Please enter a valid postal code format (e.g., V6B 1A1)";h(e),V(null),l&&l(e);return}d(!0);try{console.log("Checking service area for:",n);let e=(0,o.mP)(n);if(console.log("Service area result:",e),V(e),e)c&&c(e,n);else{let e="We don't currently service this area. Please contact us for special arrangements.";h(e),l&&l(e)}}catch(s){console.error("Error checking postal code:",s);let e="An error occurred while checking your postal code";h(e),V(null),l&&l(e)}finally{d(!1)}},detectLocation=async()=>{v(!0),h(null),T(null);try{console.log("Detecting location..."),T("Please allow location access when prompted. This may take a few seconds...");let e=await (0,o.ei)();if(console.log("Detected postal code:",e),!e){let e="Unable to detect your postal code. Please enter it manually.";h(e),T("The location service could not determine your postal code. Try entering a nearby postal code instead."),l&&l(e);return}m(e),T(null),console.log("Checking service area for detected postal code:",e);let s=(0,o.mP)(e);if(console.log("Service area result for detected postal code:",s),V(s),x(!0),s)c&&c(s,e);else{let e="We don't currently service this area. Please contact us for special arrangements.";h(e),l&&l(e)}}catch(s){console.error("Location detection error:",s);let e=s.message||"Failed to detect your location";h(e),T("This could be due to browser permissions, network issues, or API limitations. Please try entering your postal code manually instead."),l&&l(e)}finally{v(!1)}};return(0,r.jsx)("div",{className:"".concat("compact"===a?"":"bg-white rounded-lg shadow-lg"," ").concat(s),children:(0,r.jsxs)("div",{className:"compact"===a?"p-0":"p-6",children:["default"===a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"text-xl font-bold mb-2",children:"Check If We Service Your Area"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Enter your postal code to check if we provide doorstep repair service in your area."})]}),(0,r.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("div",{className:"relative flex-grow",children:[(0,r.jsx)("input",{ref:D,type:"text",value:n,onChange:e=>m(e.target.value.toUpperCase()),placeholder:"Enter postal code (e.g., V6B 1A1)",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500 pl-10 text-gray-800 placeholder-gray-400 font-medium","aria-label":"Postal Code"}),(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(t.U41,{className:"h-5 w-5 text-gray-400"})})]}),(0,r.jsx)("button",{type:"button",onClick:e=>handleSubmit(e),className:"ml-3 px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",disabled:y,children:y?(0,r.jsx)(t.fCD,{className:"animate-spin h-5 w-5"}):"Check"})]}),(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("span",{className:"px-3 text-gray-500 text-sm",children:"or"})}),(0,r.jsx)("button",{type:"button",onClick:detectLocation,disabled:u,className:"w-full flex justify-center items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.fCD,{className:"animate-spin h-5 w-5 mr-2"}),"Detecting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.Nh4,{className:"h-5 w-5 mr-2 text-gray-500"}),"Use My Current Location"]})})]}),g&&(b||p)?y?(0,r.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,r.jsx)(t.fCD,{className:"animate-spin text-primary-600 text-2xl"})}):p?(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(t.G5m,{className:"h-5 w-5 text-red-500"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Service Area Check"}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-red-700",children:[(0,r.jsx)("p",{children:p}),f&&(0,r.jsx)("p",{className:"mt-1 text-xs",children:f})]}),p.includes("don't currently service")&&(0,r.jsx)("div",{className:"mt-4",children:c||l?(0,r.jsx)("span",{className:"text-sm font-medium text-red-800",children:"Please contact us for special arrangements"}):(0,r.jsx)("a",{href:"/contact/",className:"text-sm font-medium text-red-800 hover:text-red-900",children:"Contact us for special arrangements →"})})]})]})}):b?(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(t.FJM,{className:"h-5 w-5 text-green-500"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-green-800",children:"Good News!"}),(0,r.jsxs)("div",{className:"mt-2 text-sm text-green-700",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:b.city})," is in our service area!",n&&(0,r.jsxs)("span",{className:"block text-xs mt-1",children:["Based on postal code: ",(0,r.jsx)("span",{className:"font-mono",children:n})]})]}),(0,r.jsxs)("ul",{className:"mt-2 space-y-1 list-disc list-inside",children:[(0,r.jsx)("li",{children:b.sameDay?"Same-day service is available in your area!":"Same-day service is not available, but we can schedule a visit"}),(0,r.jsxs)("li",{children:["Typical response time: ",b.responseTime]}),b.travelFee?(0,r.jsxs)("li",{children:["Travel fee: $",b.travelFee," (added to repair cost)"]}):(0,r.jsx)("li",{children:"No travel fee for your area"})]})]}),!c&&!l&&(0,r.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,r.jsx)("a",{href:"/book-online/",className:"text-sm font-medium text-green-800 hover:text-green-900",children:"Book a repair now →"}),(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-green-800 hover:text-green-900 cursor-pointer flex items-center",children:"View our services →"}),(0,r.jsx)("div",{className:"absolute left-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-10",children:(0,r.jsxs)("div",{className:"py-1",role:"menu","aria-orientation":"vertical",children:[(0,r.jsx)("a",{href:"/services/mobile/",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Mobile Repair"}),(0,r.jsx)("a",{href:"/services/laptop/",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",role:"menuitem",children:"Laptop Repair"})]})})]})]})]})]})}):null:null,"default"===a&&(0,r.jsxs)("div",{className:"mt-4 text-sm text-gray-500 flex items-start",children:[(0,r.jsx)(t.DAO,{className:"h-4 w-4 mr-2 text-gray-400 mt-0.5"}),(0,r.jsx)("p",{children:"We service most areas in the Lower Mainland, including Vancouver, Burnaby, Richmond, Surrey, Coquitlam, Port Coquitlam, North Vancouver, West Vancouver, New Westminster, Delta, Langley, Maple Ridge, Pitt Meadows, and White Rock. We also cover Squamish, Whistler, Victoria, Nanaimo, and Fraser Valley communities up to Chilliwack with adjusted service timeframes and travel fees for some areas."})]})]})})}},3597:function(e,s,a){a.d(s,{MM:function(){return isValidPostalCodeFormat},ei:function(){return getCurrentLocationPostalCode},mP:function(){return checkServiceArea}});let r={V0N1T0:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V0N1H0:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V8B0V1:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V0N1B0:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B1:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B2:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B3:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B4:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B5:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B6:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B7:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B8:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B9:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V8E0A1:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V6B1A1:{city:"Downtown Vancouver",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5K0A1:{city:"East Vancouver",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V6E1V3:{city:"West End Vancouver",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5Y1V4:{city:"Mount Pleasant",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5T3H5:{city:"Fairview",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5:{city:"Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6:{city:"Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V3N:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5A:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5B:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5C:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5E:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5G:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5H:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5J:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6V:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6W:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6X:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6Y:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7A:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7B:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7C:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V3R:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3S:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3T:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3V:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3W:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3X:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4A:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4N:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4P:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3B:{city:"Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3C:{city:"Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3E:{city:"Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3H:{city:"Port Moody",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3K:{city:"Port Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V7G:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7H:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7J:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7K:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7L:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7M:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7N:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7P:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7R:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7S:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7T:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7V:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7W:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V3L:{city:"New Westminster",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3M:{city:"New Westminster",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4C:{city:"Delta",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4E:{city:"Delta",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4K:{city:"Ladner",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4L:{city:"Tsawwassen",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4M:{city:"Tsawwassen",serviceable:!0,sameDay:!1,responseTime:"Next day"},V1M:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2Y:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2Z:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V3A:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4W:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4B:{city:"White Rock",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2W:{city:"Maple Ridge",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2X:{city:"Maple Ridge",serviceable:!0,sameDay:!1,responseTime:"Next day"},V3Y:{city:"Pitt Meadows",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4R:{city:"Maple Ridge",serviceable:!0,sameDay:!1,responseTime:"Next day"},V8B:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V8E:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V2P:{city:"Chilliwack",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V2R:{city:"Chilliwack",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V2S:{city:"Abbotsford",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V2T:{city:"Abbotsford",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V3G:{city:"Abbotsford",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V2V:{city:"Mission",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V4S:{city:"Mission",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V0V:{city:"Sea to Sky Corridor",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V0N:{city:"Sea to Sky Region",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V9R:{city:"Nanaimo",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9S:{city:"Nanaimo",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9T:{city:"Nanaimo",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8N:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8P:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8R:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8S:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8T:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8V:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8W:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8X:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8Y:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8Z:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9A:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9B:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"}},isValidPostalCodeFormat=e=>{if(!e)return!1;let s=e.replace(/[^A-Za-z0-9]/g,"").toUpperCase();if(3===s.length){if(!/^[A-Z]/.test(s)||/^[DFIOQU]/.test(s))return console.log("Invalid first character in partial postal code"),!1;let e=/^[A-Z]\d[A-Z]$/.test(s);if(e)return console.log("Valid partial postal code:",s),!0}if(6!==s.length)return console.log("Invalid postal code length:",s.length),!1;if(!/^[A-Z]/.test(s)||/^[DFIOQU]/.test(s))return console.log("Invalid first character in postal code"),!1;let a=/^[A-Z]\d[A-Z]\d[A-Z]\d$/.test(s);return console.log("Postal code validation result for",s,":",a),a},normalizePostalCode=e=>e?e.replace(/[^A-Za-z0-9]/g,"").toUpperCase():"",checkServiceArea=e=>{if(console.log("Checking service area for postal code:",e),!e)return console.error("No postal code provided"),null;let s=isValidPostalCodeFormat(e);if(!s)return console.error("Invalid postal code format:",e),null;let a=normalizePostalCode(e);console.log("Normalized postal code:",a);let i=Object.keys(r).slice(0,10);if(console.log("Some postal code map keys:",i),console.log("Looking for FSA V5A in map:","V5A"in r),r[a])return console.log("Found exact match for full postal code:",a),r[a];let t=a.substring(0,5);if(r[t])return console.log("Found match for 5-character prefix:",t),r[t];let o=a.substring(0,4);if(r[o])return console.log("Found match for 4-character prefix:",o),r[o];let c=a.substring(0,3);if(console.log("Looking for prefix match:",c),r[c])return console.log("Found match for 3-character FSA:",c),r[c];let l=a.substring(0,2);return(console.log("Looking for area code match:",l),"V5"===l||"V6"===l)?(console.log("Found match for Vancouver area code:",l),r[l]):"V7J"===c?(console.log("Special case: V7J for North Vancouver"),{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"}):(console.log("No service area match found for postal code:",e),console.log("Tried:",a,t,o,c,l),null)},getCurrentLocationPostalCode=async()=>new Promise((e,s)=>{if(!navigator.geolocation){s("Geolocation is not supported by your browser");return}let a=setTimeout(()=>{s("Location detection timed out. Please try entering your postal code manually.")},2e4);navigator.geolocation.getCurrentPosition(async r=>{try{var i;clearTimeout(a);let{latitude:t,longitude:o}=r.coords;console.log("Detected coordinates:",t,o);let c="";try{console.log("Trying Nominatim API...");let e=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(t,"&lon=").concat(o,"&addressdetails=1&zoom=18"),{headers:{"Accept-Language":"en-US,en","User-Agent":"TheTravellingTechnicians/1.0"},cache:"no-cache"});if(e.ok){let s=await e.json();console.log("Nominatim response:",s),(null===(i=s.address)||void 0===i?void 0:i.postcode)&&(c=s.address.postcode,console.log("Found postal code from Nominatim:",c))}else console.error("Nominatim API error:",e.status,e.statusText)}catch(e){console.error("Error with Nominatim API:",e)}if(!c){let e=t>=49.2&&t<=49.3&&o>=-123.2&&o<=-123?"V6B 1A1":t>=49.3&&t<=49.4&&o>=-123.1&&o<=-122.9?"V7J 1A1":t>=49.2&&t<=49.3&&o>=-123&&o<=-122.9?"V5B 1A1":t>=49.1&&t<=49.2&&o>=-123.2&&o<=-123?"V6Y 1A1":t>=49.1&&t<=49.2&&o>=-122.9&&o<=-122.7?"V3R 1A1":t>=49&&t<=49.5&&o>=-123.5&&o<=-122.5?"V6B 1A1":null;e&&(c=e,console.log("Using rough location fallback:",c))}if(!c){s("Could not determine postal code from your location");return}let l=c.toUpperCase().trim();if(6===l.length&&/^[A-Z]\d[A-Z]\d[A-Z]\d$/.test(l)&&(l="".concat(l.slice(0,3)," ").concat(l.slice(3))),console.log("Formatted postal code:",l),!isValidPostalCodeFormat(l)){let e=l.substring(0,3);if(/^[A-Z]\d[A-Z]$/.test(e))l="".concat(e," 1A1"),console.log("Created placeholder postal code:",l);else{s("Invalid postal code format detected: ".concat(l));return}}e(l)}catch(e){clearTimeout(a),console.error("Error fetching address data:",e),s("Error fetching address data. Please try entering your postal code manually.")}},e=>{clearTimeout(a),console.error("Geolocation permission error:",e);let r="An unknown location error occurred.";1===e.code?r="Location permission denied. Please allow location access in your browser settings.":2===e.code?r="Location information is unavailable. Your device may not support precise location.":3===e.code&&(r="Location request timed out. Please check your internet connection and try again."),s(r)},{enableHighAccuracy:!0,maximumAge:3e4,timeout:15e3})})}}]);