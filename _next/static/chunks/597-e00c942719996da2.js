"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[597],{3597:function(e,s,a){a.d(s,{MM:function(){return isValidPostalCodeFormat},ei:function(){return getCurrentLocationPostalCode},mP:function(){return checkServiceArea}});let r={V0N1T0:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V0N1H0:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V8B0V1:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V0N1B0:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B1:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B2:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B3:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B4:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B5:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B6:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B7:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B8:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V0N1B9:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V8E0A1:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V6B1A1:{city:"Downtown Vancouver",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5K0A1:{city:"East Vancouver",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V6E1V3:{city:"West End Vancouver",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5Y1V4:{city:"Mount Pleasant",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5T3H5:{city:"Fairview",serviceable:!0,sameDay:!0,responseTime:"30-60 minutes"},V5:{city:"Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6:{city:"Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V3N:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5A:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5B:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5C:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5E:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5G:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5H:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V5J:{city:"Burnaby",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6V:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6W:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6X:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V6Y:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7A:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7B:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7C:{city:"Richmond",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V3R:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3S:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3T:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3V:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3W:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3X:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4A:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4N:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4P:{city:"Surrey",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3B:{city:"Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3C:{city:"Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3E:{city:"Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3H:{city:"Port Moody",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3K:{city:"Port Coquitlam",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V7G:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7H:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7J:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7K:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7L:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7M:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7N:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7P:{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7R:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7S:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7T:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7V:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V7W:{city:"West Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"},V3L:{city:"New Westminster",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V3M:{city:"New Westminster",serviceable:!0,sameDay:!0,responseTime:"2-3 hours"},V4C:{city:"Delta",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4E:{city:"Delta",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4K:{city:"Ladner",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4L:{city:"Tsawwassen",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4M:{city:"Tsawwassen",serviceable:!0,sameDay:!1,responseTime:"Next day"},V1M:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2Y:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2Z:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V3A:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4W:{city:"Langley",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4B:{city:"White Rock",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2W:{city:"Maple Ridge",serviceable:!0,sameDay:!1,responseTime:"Next day"},V2X:{city:"Maple Ridge",serviceable:!0,sameDay:!1,responseTime:"Next day"},V3Y:{city:"Pitt Meadows",serviceable:!0,sameDay:!1,responseTime:"Next day"},V4R:{city:"Maple Ridge",serviceable:!0,sameDay:!1,responseTime:"Next day"},V8B:{city:"Squamish",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V8E:{city:"Whistler",serviceable:!0,sameDay:!1,travelFee:50,responseTime:"1-2 days"},V2P:{city:"Chilliwack",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V2R:{city:"Chilliwack",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V2S:{city:"Abbotsford",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V2T:{city:"Abbotsford",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V3G:{city:"Abbotsford",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V2V:{city:"Mission",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V4S:{city:"Mission",serviceable:!0,sameDay:!1,travelFee:25,responseTime:"1-2 days"},V0V:{city:"Sea to Sky Corridor",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V0N:{city:"Sea to Sky Region",serviceable:!0,sameDay:!1,travelFee:35,responseTime:"1-2 days"},V9R:{city:"Nanaimo",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9S:{city:"Nanaimo",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9T:{city:"Nanaimo",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8N:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8P:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8R:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8S:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8T:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8V:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8W:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8X:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8Y:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V8Z:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9A:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"},V9B:{city:"Victoria",serviceable:!0,sameDay:!1,travelFee:75,responseTime:"2-3 days"}},isValidPostalCodeFormat=e=>{if(!e)return!1;let s=e.replace(/[^A-Za-z0-9]/g,"").toUpperCase();if(3===s.length){if(!/^[A-Z]/.test(s)||/^[DFIOQU]/.test(s))return console.log("Invalid first character in partial postal code"),!1;let e=/^[A-Z]\d[A-Z]$/.test(s);if(e)return console.log("Valid partial postal code:",s),!0}if(6!==s.length)return console.log("Invalid postal code length:",s.length),!1;if(!/^[A-Z]/.test(s)||/^[DFIOQU]/.test(s))return console.log("Invalid first character in postal code"),!1;let a=/^[A-Z]\d[A-Z]\d[A-Z]\d$/.test(s);return console.log("Postal code validation result for",s,":",a),a},normalizePostalCode=e=>e?e.replace(/[^A-Za-z0-9]/g,"").toUpperCase():"",checkServiceArea=e=>{if(console.log("Checking service area for postal code:",e),!e)return console.error("No postal code provided"),null;let s=isValidPostalCodeFormat(e);if(!s)return console.error("Invalid postal code format:",e),null;let a=normalizePostalCode(e);console.log("Normalized postal code:",a);let i=Object.keys(r).slice(0,10);if(console.log("Some postal code map keys:",i),console.log("Looking for FSA V5A in map:","V5A"in r),r[a])return console.log("Found exact match for full postal code:",a),r[a];let o=a.substring(0,5);if(r[o])return console.log("Found match for 5-character prefix:",o),r[o];let t=a.substring(0,4);if(r[t])return console.log("Found match for 4-character prefix:",t),r[t];let c=a.substring(0,3);if(console.log("Looking for prefix match:",c),r[c])return console.log("Found match for 3-character FSA:",c),r[c];let l=a.substring(0,2);return(console.log("Looking for area code match:",l),"V5"===l||"V6"===l)?(console.log("Found match for Vancouver area code:",l),r[l]):"V7J"===c?(console.log("Special case: V7J for North Vancouver"),{city:"North Vancouver",serviceable:!0,sameDay:!0,responseTime:"1-2 hours"}):(console.log("No service area match found for postal code:",e),console.log("Tried:",a,o,t,c,l),null)},getCurrentLocationPostalCode=async()=>new Promise((e,s)=>{if(!navigator.geolocation){s("Geolocation is not supported by your browser");return}let a=setTimeout(()=>{s("Location detection timed out. Please try entering your postal code manually.")},2e4);navigator.geolocation.getCurrentPosition(async r=>{try{var i;clearTimeout(a);let{latitude:o,longitude:t}=r.coords;console.log("Detected coordinates:",o,t);let c="";try{console.log("Trying Nominatim API...");let e=await fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat=".concat(o,"&lon=").concat(t,"&addressdetails=1&zoom=18"),{headers:{"Accept-Language":"en-US,en","User-Agent":"TheTravellingTechnicians/1.0"},cache:"no-cache"});if(e.ok){let s=await e.json();console.log("Nominatim response:",s),(null===(i=s.address)||void 0===i?void 0:i.postcode)&&(c=s.address.postcode,console.log("Found postal code from Nominatim:",c))}else console.error("Nominatim API error:",e.status,e.statusText)}catch(e){console.error("Error with Nominatim API:",e)}if(!c){let e=o>=49.2&&o<=49.3&&t>=-123.2&&t<=-123?"V6B 1A1":o>=49.3&&o<=49.4&&t>=-123.1&&t<=-122.9?"V7J 1A1":o>=49.2&&o<=49.3&&t>=-123&&t<=-122.9?"V5B 1A1":o>=49.1&&o<=49.2&&t>=-123.2&&t<=-123?"V6Y 1A1":o>=49.1&&o<=49.2&&t>=-122.9&&t<=-122.7?"V3R 1A1":o>=49&&o<=49.5&&t>=-123.5&&t<=-122.5?"V6B 1A1":null;e&&(c=e,console.log("Using rough location fallback:",c))}if(!c){s("Could not determine postal code from your location");return}let l=c.toUpperCase().trim();if(6===l.length&&/^[A-Z]\d[A-Z]\d[A-Z]\d$/.test(l)&&(l="".concat(l.slice(0,3)," ").concat(l.slice(3))),console.log("Formatted postal code:",l),!isValidPostalCodeFormat(l)){let e=l.substring(0,3);if(/^[A-Z]\d[A-Z]$/.test(e))l="".concat(e," 1A1"),console.log("Created placeholder postal code:",l);else{s("Invalid postal code format detected: ".concat(l));return}}e(l)}catch(e){clearTimeout(a),console.error("Error fetching address data:",e),s("Error fetching address data. Please try entering your postal code manually.")}},e=>{clearTimeout(a),console.error("Geolocation permission error:",e);let r="An unknown location error occurred.";1===e.code?r="Location permission denied. Please allow location access in your browser settings.":2===e.code?r="Location information is unavailable. Your device may not support precise location.":3===e.code&&(r="Location request timed out. Please check your internet connection and try again."),s(r)},{enableHighAccuracy:!0,maximumAge:3e4,timeout:15e3})})}}]);